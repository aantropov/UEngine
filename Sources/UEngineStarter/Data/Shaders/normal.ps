#version 330 core

#define maxLight 8
#define maxBones 64

uniform struct Material
{
	sampler2D normal;
} material;

uniform struct Transform
{
	mat4 model;
	mat4 viewProjection;	
	mat3 normal;
	vec3 viewPosition;
        mat4 modelViewProjection;
} transform;

in Vertex {
	vec4  position;
	vec2  texcoord;
	vec3  normal;
	vec3  lightDir[maxLight];
	vec3  lightDirTBN[maxLight];
	vec3  viewDirTBN;
	vec3  viewDir;
	vec4 smcoord[maxLight];	
	vec3 t;
	vec3 b;
	mat3 transformNormal;
} Vert;

out vec4 color;

void main(void)
{
	vec3 bump = (texture(material.normal, Vert.texcoord).xyz * 2.0 - 1.0);
	//bump *= Vert.transformNormal;	
	mat3 m = mat3((Vert.t), (Vert.b), (Vert.normal));	
	bump *= transpose(m);
	
	color = vec4(bump,1);
}
